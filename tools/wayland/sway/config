### --- Includes ---
include ~/.config/sway/definitions.conf
include ~/.config/sway/windowrules.conf
include ~/.config/sway/keybinds.conf

input "type:keyboard" {
    xkb_layout us
}

### --- Aesthetics ---
default_border pixel 2
default_floating_border pixel 2
smart_gaps on
gaps inner 5
gaps outer 0

# IMPORTANT: Disable the built-in swaybar so Waybar can take over
bar {
    swaybar_command /usr/bin/true
}

### --- Startup (One-time) ---
# Background services that don't need to restart on reload
exec {
    swww-daemon
    cb
    udiskie
    nm-applet
    /usr/lib/polkit-kde-authentication-agent-1
    /usr/bin/gnome-keyring-daemon --start --components=secrets
}

### --- Startup (Always refresh on reload) ---
# We wrap these in 'sh -c' to ensure the semicolon logic works 100% of the time.
# The '|| true' ensures that even if nothing is killed, the app still starts.

exec_always {
    # Waybar
    exec sh -c 'pkill waybar || true; waybar -c ~/.config/waybar/waybar_sway -s ~/.config/waybar/style.css'

    # Notifications
    exec sh -c 'pkill dunst || true; dunst'

    # Kanshi
    exec sh -c 'pkill kanshi || true; kanshi'
}
