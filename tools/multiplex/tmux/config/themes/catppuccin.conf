# Catppuccin Mocha Tmux Theme
# ----------------------------=== Colors ===--------------------------
# Catppuccin Mocha palette
thm_bg="#1e1e2e"         # Catppuccin base (main background)
thm_fg="#cdd6f4"         # Catppuccin text (main foreground)
thm_cyan="#94e2d5"       # Catppuccin teal
thm_black="#11111b"      # Catppuccin crust (darkest background)
thm_gray="#181825"       # Catppuccin mantle (secondary background for statusline/messages)
thm_magenta="#cba6f7"    # Catppuccin mauve
thm_pink="#f5c2e7"       # Catppuccin pink
thm_red="#f38ba8"        # Catppuccin red
thm_green="#a6e3a1"      # Catppuccin green
thm_yellow="#f9e2af"     # Catppuccin yellow
thm_blue="#89b4fa"       # Catppuccin blue
thm_orange="#fab387"     # Catppuccin peach
thm_dark="#bac2de"       # Catppuccin subtext1 (for subtle borders, more visible than gray)

# ----------------------------=== Theme ===--------------------------
set -g status-position top
set -g status "on"
set -g status-bg "${thm_bg}"
set -g status-justify "left"
set -g status-left-length "100"
set -g status-right-length "100"

# messages
set -g message-style fg="${thm_cyan}",bg="${thm_gray}",align="centre"
set -g message-command-style fg="${thm_cyan}",bg="${thm_gray}",align="centre"

# borders
set-window-option -g pane-active-border-style fg=$thm_green
set-window-option -g pane-border-style fg=$thm_dark

# tunes widget (assuming $DOTFILES is correctly set in your shell environment)
tm_tunes="#(osascript -l JavaScript $DOTFILES/tools/multiplex/tmux/config/themes/applescripts/tunes.js)"
tm_tunes_display="#[bg=${thm_bg}]#[fg=$thm_pink]#[bg=$thm_pink]#[fg=$thm_bg] #[fg=$thm_bg,bg=$thm_pink] ${tm_tunes} #[bg=${thm_bg}]#[fg=$thm_pink]"

# status elements
# Session display: Green background, text foreground, with powerline separators.
session="#[fg=$thm_blue]#[bg=$thm_gray]#[bg=$thm_blue]#[fg=$thm_bg] #[fg=$thm_bg,bg=$thm_blue] #S #[bg=${thm_magenta}]#[fg=$thm_blue]"
# Clock display: Blue background, text foreground, with powerline separators.
clock="#[fg=$thm_orange]#[fg=$thm_bg,bg=$thm_orange] #[bg=$thm_orange]#[fg=$thm_bg] %H:%M#[bg=${thm_bg}]#[fg=$thm_orange]"
# Window display: Yellow background, text foreground, with powerline separators.
window="#[fg=$thm_fg,bg=$thm_magenta]#[bg=${thm_magenta}]#[fg=$thm_bg]#{?#{window_name},#{b:window_icon} #{window_name},#{b:pane_current_path}} #[bg=${thm_bg}]#[fg=$thm_magenta]"

# Disable default left/right status elements
set -g status-left ""
set -g status-right ""

# Centered format with left/right content (session on left, window on left, tunes in center, clock on right)
set -g status-format[0] \
"#[align=left]$session \
#[align=left]$window \
#[align=centre]$tm_tunes_display \
#[align=right]$clock"

# ----------- App Icon Mapping (set with window_icon) -----------
# Map common app names to Nerd Font icons. This part is unchanged as icons are universal.
set-hook -g after-new-window "run-shell 'tmux setenv -g TMUX_APP_ICON_#{window_index} \"#( \
  case #{window_name} in \
    zsh|bash) echo \"\" ;; \
    nvim) echo \"\" ;; \
    vim) echo \"\" ;; \
    git) echo \"\" ;; \
    htop) echo \"\" ;; \
    *) echo \"\" ;; \
  esac \
)\"'"

# Window status format: non-current window.
# Index with background, then text with icon.
setw -g window-status-format "#[fg=$thm_bg,bg=$thm_gray] #I #[fg=$thm_fg,bg=$thm_gray] #{?#{window_name},#{b:TMUX_APP_ICON_#{window_index}} #{window_name},#{b:pane_current_path}} "
# Current window status format: active window.
# Bold index with accent background, then text with icon on main background.
setw -g window-status-current-format "#[fg=$thm_bg,bg=$thm_green,bold] #I #[fg=$thm_fg,bg=$thm_bg,bold] #{?#{window_name},#{b:TMUX_APP_ICON_#{window_index}} #{window_name},#{b:pane_current_path}} "

# Modes
setw -g clock-mode-colour "${thm_blue}"
setw -g mode-style "fg=${thm_pink} bg=$thm_dark bold"
